// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// generator client {
//   provider = "prisma-client-js"
// }

// datasource db {
//   provider = "postgresql"
//   url      = env("DATABASE_URL")
// }

datasource db {
    provider = "sqlite"
    url      = "file:./dev.sqlite"
}

generator client {
    provider = "prisma-client-js"
}

model User {
    id            String      @id @default(uuid())
    createdAt     DateTime    @default(now())
    updatedAt     DateTime    @updatedAt
    username      String
    email         String      @unique
    pwHash        String
    createdWorlds World[]
    roles         WorldRole[]
    groups        UserGroup[]
}

model World {
    id        String      @id @default(uuid())
    createdAt DateTime    @default(now())
    updatedAt DateTime    @updatedAt
    name      String
    creator   User        @relation(fields: [creatorId], references: [id])
    creatorId String
    groups    UserGroup[]
    roles     WorldRole[]

    @@unique([name, creatorId])
}

model WorldRole {
    id      String @id @default(uuid())
    user    User   @relation(fields: [userId], references: [id])
    userId  String
    level   Int
    world   World  @relation(fields: [worldId], references: [id])
    worldId String

    @@unique([userId, worldId])
}

model UserGroup {
    id      String @id @default(uuid())
    name    String
    world   World  @relation(fields: [worldId], references: [id])
    worldId String
    users   User[]
}
